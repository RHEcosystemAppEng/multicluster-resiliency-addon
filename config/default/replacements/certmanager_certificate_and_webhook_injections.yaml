# reference the webhook service name in the certificate dns names (target is name.namespace)
- source:
    fieldPath: metadata.name
    kind: Service
    name: webhook-service
  targets:
    - fieldPaths:
        - spec.dnsNames.0
        - spec.dnsNames.1
      select:
        kind: Certificate
      options:
        delimiter: .
        index: 0
# reference the webhook service namespace in the certificate dns names (target is name.namespace)
- source:
    fieldPath: metadata.namespace
    kind: Service
    name: webhook-service
  targets:
    - fieldPaths:
        - spec.dnsNames.0
        - spec.dnsNames.1
      select:
        kind: Certificate
      options:
        delimiter: .
        index: 1
# reference the certificate namespace in a crd annotation (target is namespace/name)
- source:
    fieldPath: metadata.namespace
    kind: Certificate
    name: serving-cert
  targets:
    - fieldPaths:
        - metadata.annotations.[cert-manager.io/inject-ca-from]
      select:
        kind: CustomResourceDefinition
      options:
        delimiter: /
        index: 0
    - fieldPaths:
        - metadata.annotations.[cert-manager.io/inject-ca-from]
      select:
        kind: ValidatingWebhookConfiguration
      options:
        delimiter: /
        index: 0
# reference the certificate name in a crd annotation (target is namespace/name)
- source:
    fieldPath: metadata.name
    kind: Certificate
    name: serving-cert
  targets:
    - fieldPaths:
        - metadata.annotations.[cert-manager.io/inject-ca-from]
      select:
        kind: CustomResourceDefinition
      options:
        delimiter: /
        index: 1
    - fieldPaths:
        - metadata.annotations.[cert-manager.io/inject-ca-from]
      select:
        kind: ValidatingWebhookConfiguration
      options:
        delimiter: /
        index: 1
